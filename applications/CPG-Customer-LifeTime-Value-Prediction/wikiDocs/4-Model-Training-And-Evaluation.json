{
  "id": 3378,
  "uuid": "b7962583-b9a7-48d5-9712-9e9b37c01fc6",
  "name": "4-Model-Training-And-Evaluation",
  "category": "",
  "projectId": 1625,
  "content": "<h1>Model Training and Evaluation</h1><p><br></p><h2>Objective:</h2><p>The objective of this guide is to provide a comprehensive overview of training and evaluating machine learning models for predicting Customer Lifetime Value (CLV). This project uses Spark ML's Linear Regression and KMeans clustering models in SparkFlows. These methods are chosen for their ability to handle large-scale data efficiently and their applicability to regression and segmentation tasks.</p><h3><br></h3><h4>Linear Regression (Spark ML):</h4><p>Linear Regression is a supervised learning algorithm used to model the relationship between a dependent variable (target) and one or more independent variables (features). It assumes a linear relationship between the features and the target, predicting CLV as a continuous variable.</p><h4>KMeans Clustering (Spark ML):</h4><p>KMeans is an unsupervised clustering algorithm used to group customers into segments based on their features. It assigns each customer to the cluster with the nearest centroid, identifying patterns and customer groups that share similar characteristics.</p><p><br></p><h2>Approach:</h2><h4>1. Data Preprocessing:</h4><ul><li>Data Cleaning:</li><li>Handle missing values in key columns like CustomerId and Sum_total_inv_Amt by imputing or removing them.</li><li>Remove duplicates and inconsistencies in the data.</li><li>Feature Engineering:</li><li>Create additional features such as Frequency, Recency, and Cust_Unique_PrdCnt from transactional data.</li><li>Normalize numerical features like Avg_Total_Inv_Amt and Sum_Total_Inv_Amt for better performance during training.</li><li>Train-Test Split:</li><li>Divide the dataset into training and testing subsets to evaluate model performance on unseen data.</li></ul><h4>2. Model Training:</h4><p>Linear Regression Model:</p><ul><li>Training Process:</li><li>Train the model on features like Frequency, Recency, Avg_Total_Inv_Amt, and Cust_Unique_PrdCnt to predict CLV.</li><li>Use Spark ML's LinearRegression node to handle large-scale data efficiently.</li><li>Hyperparameter Tuning:</li><li>Tune parameters such as the learning rate, maximum iterations, and regularization parameters (L1 or L2 regularization) to improve model performance.</li></ul><h2><br></h2><p>KMeans Clustering:</p><ul><li>Training Process:</li><li>Train a KMeans model using features such as Frequency, Recency, AvgDaysBetween, and Sum_Total_Inv_Amt to segment customers into clusters based on behavior.</li><li>Use Spark ML's KMeans node to scale and optimize the clustering process.</li><li>Hyperparameter Tuning:</li><li>Adjust the number of clusters (k) to identify the optimal segmentation of customers.</li></ul><h4>3. Model Evaluation:</h4><p>Linear Regression Evaluation Metrics:</p><ul><li>Mean Absolute Error (MAE): Measures the average magnitude of errors in predictions.</li><li>Mean Squared Error (MSE): Provides the average squared difference between actual and predicted CLV values.</li><li>R-squared (RÂ²): Indicates the proportion of variance in the target variable explained by the features.</li></ul><p>KMeans Evaluation Metrics:</p><ul><li>Silhouette Score: Evaluates how well each customer is clustered based on intra-cluster distance and inter-cluster separation.</li><li>Cluster Size Distribution: Ensures clusters are meaningful and not skewed toward a single group.</li></ul><p>Cross-Validation:</p><ul><li>Apply k-fold cross-validation to validate model performance and reduce the risk of overfitting.</li></ul>",
  "icon": "{\"type\":\"svg\",\"icon\":\"images/createApplications.svg\"}",
  "description": "",
  "syncedWithGithub": false,
  "createdBy": "admin",
  "dateCreated": "Aug 2, 2025, 12:11:34 PM",
  "updatedBy": "rohan",
  "dateLastUpdated": "Sep 12, 2025, 8:36:46 AM"
}