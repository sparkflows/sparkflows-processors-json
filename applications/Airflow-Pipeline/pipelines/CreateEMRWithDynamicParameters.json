{
  "name": "CreateEMRWithDynamicParameters",
  "uuid": "ea9355eb-59f9-4fdc-9cdb-141b6504122a",
  "category": "EMR",
  "description": "-",
  "parameters": "--var path='pipeline_config.json' --var subnet_id=subnet-42456219 --var instance_type=m4.xlarge",
  "nodes": [
    {
      "id": "1",
      "path": "/03-EMR/",
      "name": "Create EMR JobFlow",
      "description": "This node creates a new EMR JobFlow by using details in configuration and passes the EMR ID to the next step.",
      "details": "<h2>Create EMR cluster</h2>\n<br>\nThis node creates a new EMR JobFlow by using details in configuration and passes the EMR ID to the next step.<br>",
      "examples": "<h2> Create EMR JobFlow Examples</h2>\n<br>\n<h4> Example of Instance Groups</h4>\n<br>\n{<br>\n\"Name\": \"Master\",<br>\n\"Market\": \"ON_DEMAND\",<br>\n\"InstanceRole\": \"MASTER\",<br>\n\"InstanceType\": \"m5.xlarge\",<br>\n\"InstanceCount\": 1,<br>\n\"EbsVolumeSizeInGB\": 100,<br>\n\"EbsVolumeType\": \"gp2\",<br>\n\"EbsVolumesPerInstance\": 1<br>\n}<br>\n<br>\n<h4> Explanation</h4>\n<br>\n<ul>\n<li> This configuration creates an instance group for the master node with the specified type and count.</li>\n</ul>\n<h4> Example of Bootstrap Actions</h4>\n<br>\n{<br>\n\"Name\": \"Install Spark\",<br>\n\"ScriptBootstrapAction\": {<br>\n\"Path\": \"s3://my-bucket/bootstrap-scripts/install-spark.sh\"<br>\n}<br>\n}<br>\n<br>\n<h4> Explanation</h4>\n<br>\n<ul>\n<li> This bootstrap action runs a script from S3 to install Spark on the cluster nodes.</li>\n</ul>\n<h4> Example of Configurations</h4>\n<br>\n{<br>\n\"classification\": \"hadoop-env\",<br>\n\"propertiesKey\": \"JAVA_HOME\",<br>\n\"propertiesValue\": \"/usr/lib/jvm/java-1.8.0\"<br>\n}<br>\n<br>\n<h4> Explanation</h4>\n<br>\n<ul>\n<li> This configuration sets the JAVA_HOME environment variable for the Hadoop environment.</li>\n</ul>\n<h4> Usage</h4>\n<br>\n<ul>\n<li> Task ID: \"create_emr_jobflow_task\"</li>\n</ul>\n<h4> Example of Task Configuration</h4>\n<br>\n{<br>\n\"Name\": \"MyEMRJobFlow\",<br>\n\"ClusterName\": \"MyCluster\",<br>\n\"ReleaseLabel\": \"emr-6.2.0\",<br>\n\"LogUri\": \"s3://aws-logs-us-east-1/elasticmapreduce/\",<br>\n\"Applications\": \"Spark\",<br>\n\"JobFlowRole\": \"EMR_EC2_DefaultRole\",<br>\n\"ServiceRole\": \"EMR_DefaultRole\",<br>\n\"Ec2KeyName\": \"my-key-pair\",<br>\n\"Ec2SubnetId\": \"subnet-12345678\",<br>\n\"KeepJobFlowAliveWhenNoSteps\": \"False\",<br>\n\"TerminationProtected\": \"False\",<br>\n\"EmrManagedMasterSecurityGroup\": \"sg-12345678\",<br>\n\"EmrManagedSlaveSecurityGroup\": \"sg-87654321\",<br>\n\"Instances\": [<br>\n{<br>\n\"InstanceGroups\": [<br>\n{<br>\n\"Name\": \"Master\",<br>\n\"Market\": \"ON_DEMAND\",<br>\n\"InstanceRole\": \"MASTER\",<br>\n\"InstanceType\": \"m5.xlarge\",<br>\n\"InstanceCount\": 1,<br>\n\"EbsVolumeSizeInGB\": 100,<br>\n\"EbsVolumeType\": \"gp2\",<br>\n\"EbsVolumesPerInstance\": 1<br>\n},<br>\n{<br>\n\"Name\": \"Core\",<br>\n\"Market\": \"SPOT\",<br>\n\"InstanceRole\": \"CORE\",<br>\n\"InstanceType\": \"m5.xlarge\",<br>\n\"InstanceCount\": 2,<br>\n\"EbsVolumeSizeInGB\": 100,<br>\n\"EbsVolumeType\": \"gp2\",<br>\n\"EbsVolumesPerInstance\": 1<br>\n}<br>\n]<br>\n}<br>\n],<br>\n\"BootstrapActions\": [<br>\n{<br>\n\"Name\": \"Install Packages\",<br>\n\"ScriptBootstrapAction\": {<br>\n\"Path\": \"s3://my-bucket/scripts/install_packages.sh\",<br>\n\"Args\": [\"arg1\", \"arg2\"]<br>\n}<br>\n}<br>\n],<br>\n\"Tags\": [<br>\n{<br>\n\"Key\": \"Environment\",<br>\n\"Value\": \"Production\"<br>\n}<br>\n],<br>\n\"Configurations\": [<br>\n{<br>\n\"classification\": \"spark-env\",<br>\n\"propertiesKey\": \"SPARK_HOME\",<br>\n\"propertiesValue\": \"/usr/lib/spark\"<br>\n}<br>\n]<br>\n}<br>",
      "type": "emr",
      "nodeClass": "fire.pipelineNodes.EMR",
      "x": "342.048px",
      "y": "258.036px",
      "fields": [
        {
          "name": "Name",
          "value": "CreateName2",
          "widget": "textfield",
          "title": "Task Name",
          "description": "Unique name of the task in airflow DAG.",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ClusterName",
          "value": "EMR-1905-HDC1-Daily-{{execution_date.in_timezone('America/Chicago').strftime('%Y%m%d')}}",
          "widget": "textfield",
          "title": "Cluster Name",
          "description": "Cluster name.",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ReleaseLabel",
          "value": "emr-6.9.0",
          "widget": "textfield",
          "title": "Release Label",
          "description": "ReleaseLabel like emr-6.2.0 ,emr-6.2.1, emr-6.3.0 etc",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "LogUri",
          "value": "s3://aws-logs-us-east-1/elasticmapreduce/EMR-1905-HDC-Daily-{{execution_date.in_timezone('America/Chicago').strftime('%Y%m%d')}}/",
          "widget": "textfield",
          "title": "Log URI",
          "description": "Log URI Path",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "LogEncryptionKmsKeyId",
          "value": "",
          "widget": "textfield",
          "title": "Log Encryption Kms Key Id",
          "description": "Log Encryption Kms Key Id",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Applications",
          "value": "Spark",
          "widget": "textfield",
          "title": "Applications",
          "description": "Applications Name is Spark",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "JobFlowRole",
          "value": "EMR_EC2_DefaultRole",
          "widget": "textfield",
          "title": "JobFlow Role",
          "description": "The IAM role that was specified when the JobFlow was created. The EC2 instances of the JobFlow assume this role",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ServiceRole",
          "value": "EMR_DefaultRole",
          "widget": "textfield",
          "title": "Service Role",
          "description": "The IAM role that is assumed by the Amazon EMR service to access Amazon Web Services resources on your behalf",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "SecurityConfiguration",
          "value": "",
          "widget": "textfield",
          "title": "Security Configuration",
          "description": "SecurityConfiguration",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "CustomAmiId",
          "value": "",
          "widget": "textfield",
          "title": "Custom AMI ID",
          "description": "Custom AMI ID",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "StepConcurrencyLevel",
          "value": "1",
          "widget": "textfield",
          "title": "Step Concurrency Level",
          "description": "Step Concurrency Level",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "retries",
          "value": "",
          "widget": "textfield",
          "title": "Retries",
          "description": "Retries",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "retry_delay",
          "value": "",
          "widget": "textfield",
          "title": "Retry Delay",
          "description": "Retry Delay(seconds)",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "aws_conn_id",
          "value": "aws_s3_connection_test_for_change",
          "widget": "textfield",
          "title": "AWS Connection ID",
          "description": "AWS Connection ID",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Instances",
          "value": "",
          "widget": "tab",
          "title": "Instances",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Ec2KeyName",
          "value": "sf",
          "widget": "textfield",
          "title": "EC2 Key Name",
          "description": "EC2 Key Name",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ServiceAccessSecurityGroup",
          "value": "",
          "widget": "textfield",
          "title": "Service Access Security Group",
          "description": "Service Access Security Group",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Ec2SubnetId",
          "value": "{subnet_id}",
          "widget": "textfield",
          "title": "EC2 Subnet ID",
          "description": "EC2 Subnet ID",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "KeepJobFlowAliveWhenNoSteps",
          "value": "False",
          "widget": "array",
          "title": "Keep JobFlow Alive When No Steps",
          "description": "Specifies whether the JobFlow should remain available after completing all steps. Defaults to true",
          "optionsArray": [
            "True",
            "False"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "TerminationProtected",
          "value": "False",
          "widget": "array",
          "title": "Termination Protected",
          "description": "Indicates whether Amazon EMR will lock the cluster to prevent the EC2 instances from being terminated by an API call or user intervention, or in the event of a cluster error",
          "optionsArray": [
            "True",
            "False"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "EmrManagedMasterSecurityGroup",
          "value": "sg-06f134b77406cf93b",
          "widget": "textfield",
          "title": "EMR Managed Master Security Group",
          "description": "Parameter to specify a custom managed security group for the master instance",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "EmrManagedSlaveSecurityGroup",
          "value": "sg-0469690a2e579fc32",
          "widget": "textfield",
          "title": "EMR Managed Slave Security Group",
          "description": "Parameter to specify a custom managed security group for core and task instances",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "InstanceGroups",
          "value": "[{\"Name\":\"Master\",\"Market\":\"ON_DEMAND\",\"InstanceRole\":\"MASTER\",\"InstanceType\":\"m4.4xlarge\",\"InstanceCount\":1,\"EbsVolumeSizeInGB\":\"\",\"EbsVolumeType\":\"\",\"EbsVolumesPerInstance\":\"\"},{\"Name\":\"Slave\",\"Market\":\"ON_DEMAND\",\"InstanceRole\":\"CORE\",\"InstanceType\":\"{instance_type}\",\"InstanceCount\":\"{instance_count}\",\"EbsVolumeSizeInGB\":\"\",\"EbsVolumeType\":\"\",\"EbsVolumesPerInstance\":\"\"}]",
          "widget": "variablesList",
          "title": "Instance Groups",
          "description": "InstanceRole: Instance group role in the cluster, InstanceType: EC2 instance type, InstanceCount:Actual count of running instances,VolumeSpecification: Volume Specification,VolumesPerInstance: Volumes Per Instance",
          "optionsArray": [
            "Name",
            "Market",
            "InstanceRole",
            "InstanceType",
            "InstanceCount",
            "EbsVolumeSizeInGB",
            "EbsVolumeType",
            "EbsVolumesPerInstance"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "EbsRootVolume",
          "value": "",
          "widget": "variables",
          "title": "Ebs Root Volume",
          "description": "EBS root volume applies to the operating systems and applications that you install on the cluster.",
          "optionsArray": [
            "Size(GiB)",
            "IOPS",
            "Throughput(MiB/s)"
          ],
          "optionArrayDescription": [
            "15 - 100 GiB per volume General Purpose SSD (gp3)",
            "3000 - 16000 IOPS per volume. Choose a maximum ratio of 500:1 between IOPS and volume size.",
            "125 - 1000 MiB/s per volume. Choose a maximum ratio of 0.25:1 between throughput and IOPS."
          ],
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Bootstrapactions",
          "value": "",
          "widget": "tab",
          "title": "Bootstrap Actions",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "BootstrapActions",
          "value": "[]",
          "widget": "variablesList",
          "title": "Bootstrap Actions",
          "description": "ScriptBootstrapAction: Instance group role in the cluster",
          "optionsArray": [
            "Name",
            "ScriptBootstrapAction",
            "Arguments"
          ],
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Advanced",
          "value": "",
          "widget": "tab",
          "title": "Advanced",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Tags",
          "value": "[{\"Key\":\"COST_CENTER\",\"Value\":\"30025\"},{\"Key\":\"BUSINESS_AREA\",\"Value\":\"HDC\"}]",
          "widget": "variablesList",
          "title": "Tags",
          "description": "key: Tag Key,Value: Tag Value",
          "optionsArray": [
            "Key",
            "Value"
          ],
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Configurations",
          "value": "[{\"classification\":\"spark\",\"propertiesKey\":\"maximizeResourceAllocation\",\"propertiesValue\":\"true\"},{\"classification\":\"spark-hive-site\",\"propertiesKey\":\"hive.metastore.client.factory.class\",\"propertiesValue\":\"com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory\"}]",
          "widget": "variablesList",
          "title": "Configurations",
          "description": "key: Tag Key,Value: Tag Value",
          "optionsArray": [
            "classification",
            "propertiesKey",
            "propertiesValue"
          ],
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "2",
      "path": "/10-Configuration/",
      "name": "Add DAG Variables",
      "description": "This node executes Python code to add DAG variables using the Python operator",
      "details": "<h2>Add DAG Variables</h2>\n<br>\nThis node executes Python code to add DAG variables using the Python operator.<br>\nCreate the variable to be used accross the pipeline and push the variable name(key) and value to XCOM. And access the value of key from XCOM with pull logic.<br>\n<br>\n<b>Python code</b>:<br>\nimport time<br>\nimport os<br>\nimport binascii<br>\n<br>\ndef generateVariable(task_instance):<br>\n  START_TIME = time.time();<br>\n  HEX=hex(int(START_TIME))[2:]<br>\n  CORRELATION_ID=\"1-{}-{}\".format(HEX, binascii.hexlify(os.urandom(12)).decode('utf-8'));<br>\n  task_instance.xcom_push(key=\"correlation_id\", value = CORRELATION_ID)<br>\n<br>\n<b>Example</b>:<br>\nXCOM PUSH : task_instance.xcom_push(key=\"correlation_id\", value = CORRELATION_ID)<br>\nXCOM PULL : {{task_instance.xcom_pull(key='correlation_id')}}<br>",
      "examples": "<h2> Add DAG Variables Examples</h2>\n<br>\n<h4> Example of Python Code for Adding Variables</h4>\n<br>\nimport time<br>\nimport os<br>\nimport binascii<br>\n<br>\ndef generateVariable(task_instance, **kwargs):<br>\nSTART_TIME = time.time()<br>\nHEX = hex(int(START_TIME))[2:]<br>\nCORRELATION_ID = kwargs['dag_run'].conf.get('correlation_id')<br>\nif CORRELATION_ID:<br>\nCORRELATION_ID = CORRELATION_ID<br>\nelse:<br>\nCORRELATION_ID = \"1-{}-{}\".format(HEX, binascii.hexlify(os.urandom(12)).decode('utf-8'))<br>\ntask_instance.xcom_push(key=\"correlation_id\", value=CORRELATION_ID)<br>\n<br>\n<h4> Explanation</h4>\n<ul>\n<li> This code generates a unique correlation ID using the current timestamp and random bytes. It pushes this ID to XCOM with the key correlation_id.</li>\n</ul>\n<h4> Example of XCOM Push and Pull</h4>\n<ul>\n<li> XCOM PUSH: task_instance.xcom_push(key=\"correlation_id\", value=CORRELATION_ID)</li>\n</ul>\n<ul>\n<li> XCOM PULL: {{ task_instance.xcom_pull(key='correlation_id') }}</li>\n</ul>\n<h4> Usage</h4>\nTask ID: \"add_dag_variables_task\"<br>",
      "type": "DAGVariable",
      "nodeClass": "fire.pipelineNodes.addDAGVariables",
      "x": "97.8453px",
      "y": "261.845px",
      "fields": [
        {
          "name": "python",
          "value": "import time\nimport os\nimport binascii\n\n\ndef generateVariable(task_instance, **kwargs):\n    START_TIME = time.time()\n    HEX = hex(int(START_TIME))[2:]\n    CORRELATION_ID = kwargs['dag_run'].conf.get('correlation_id')\n    if CORRELATION_ID:\n        CORRELATION_ID = CORRELATION_ID\n        print('Inside if')\n    else:\n        CORRELATION_ID = \"1-{}-{}\".format(HEX, binascii.hexlify(os.urandom(12)).decode('utf-8'))\n        print('Inside else')\n    task_instance.xcom_push(key=\"correlation_id\", value=CORRELATION_ID)\n    CONFIG = {\"command\": {\"sub-command\": \"pwd\"}}\n    task_instance.xcom_push(key=\"CONFIG\", value=CONFIG)",
          "widget": "shellcommand",
          "title": "Python",
          "description": "Write Python Code here",
          "required": false,
          "display": false,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Name",
          "value": "generateVariable",
          "widget": "textfield",
          "title": "Task Name",
          "description": "Unique name of the task in Airflow DAG",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "python_callable",
          "value": "generateVariable",
          "widget": "textfield",
          "title": "Python Callable",
          "description": "Input name of user defined function name in the Python code.",
          "required": true,
          "display": false,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Variables",
          "value": "correlation_id",
          "widget": "textfield",
          "title": "XCOM Key Variables",
          "description": "Key variables to used to pull value from XCOM",
          "required": false,
          "display": true,
          "editable": false,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "4",
      "path": "/03-EMR/",
      "name": "Add Step EMR JobFlow",
      "description": "This node adds steps to an existing EMR job flow and executes the arguments as one command using command-runner.jar",
      "details": "<h2>Add step to EMR cluster</h2>\n<br>\nThis node adds steps to an existing EMR job flow and executes the arguments as one command using command-runner.jar.<br>\n<br>\nAddStepEMRJob uses command-runner.jar by default to run commands as a step in EMR.<br>\n<br>\nHere added example for running the spark-submit command in AddStepEMRJobFlow<br>\n<br>\nArguments: bash,-c,\"spark-submit --master yarn --deploy-mode client --class com.fire.SparkPi s3://sparkflows/fire/fire-spark-test-1.0-jar-with-dependencies.jar {arg}\"<br>",
      "examples": "<h2>Add Step EMR JobFlow Examples</h2>\n<br>\n<h4> Example of Adding a Step to EMR</h4>\n<br>\n{<br>\n\"Name\": \"Step1\",<br>\n\"StepName\": \"DataProcessing\",<br>\n\"ClusterId\": \"j-1234567890ABCDE\",<br>\n\"ActionOnFailure\": \"CONTINUE\",<br>\n\"Jar\": \"command-runner.jar\",<br>\n\"Jars\": \"my-jar1.jar,my-jar2.jar\",<br>\n\"Arguments\": \"arg1,arg2,arg3\",<br>\n\"aws_conn_id\": \"my-aws-conn-id\",<br>\n\"trigger_rule\": \"all_success\"<br>\n}<br>\n<br>\n<h4> Explanation</h4>\n<br>\n<ul>\n<li> This example demonstrates how to add a step to an existing EMR cluster using the specified fields. The Name and StepName are required, along with the Arguments and Jar fields. The ActionOnFailure specifies what to do if the step fails.</li>\n</ul>\n<h4> Example of XCOM Push</h4>\n<br>\nTo push a variable to XCOM within the EMR step, you could include logic in the Python operator to handle the processing of the step's output.<br>\n<br>\n<h4> Usage</h4>\n<ul>\n<li> Task ID: \"add_step_emr_jobflow_task\"</li>\n</ul>",
      "type": "addStep",
      "nodeClass": "fire.pipelineNodes.addStep",
      "x": "887.833px",
      "y": "254.845px",
      "fields": [
        {
          "name": "Name",
          "value": "TestPython",
          "widget": "textfield",
          "title": "Task Name",
          "description": "Unique name of the task in Airflow DAG",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "StepName",
          "value": "EMR-1905-HDC-Daily-{{execution_date.in_timezone('America/Chicago').strftime('%Y%m%d')}}",
          "widget": "textfield",
          "title": "Step Name",
          "description": "Name of emr step",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ClusterId",
          "value": "",
          "widget": "textfield",
          "title": "Cluster ID",
          "description": "If Cluster ID is empty, the step tries to pick the cluster ID from previous create EMR node(task)",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ActionOnFailure",
          "value": "CONTINUE",
          "widget": "array",
          "title": "Action On Failure",
          "description": "Action to be taken on Failure",
          "optionsArray": [
            "CANCEL_AND_WAIT",
            "CONTINUE",
            "TERMINATE_JOB_FLOW",
            "TERMINATE_CLUSTER"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Jar",
          "value": "command-runner.jar",
          "widget": "textfield",
          "title": "JAR",
          "description": "JAR",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Jars",
          "value": "command-runner.jar",
          "widget": "textfield",
          "title": "JARS",
          "description": "Comma seperated list of Jars",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": true,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "Arguments",
          "value": "bash,-c,aws s3 cp s3://fire-sample-data/load-app.py /home/hadoop;chmod +x /home/hadoop/load-app.py; python /home/hadoop/load-app.py --fire_host_url https://localhost --access_token abdkdnd-idckdn-cdnckd --folder_path {{task_instance.xcom_pull(key='correlation_id')}} --abc s3://ucdcnd/icndc {{execution_date.in_timezone('America/Chicago').strftime('%Y%m%d%H')}}",
          "widget": "textfield",
          "title": "Arguments",
          "description": "Comma seperated list of Arguments.",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": true,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "aws_conn_id",
          "value": "",
          "widget": "textfield",
          "title": "AWS Connection ID",
          "description": "AWS Connection ID",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "trigger_rule",
          "value": "all_success",
          "widget": "array",
          "title": "Trigger Rule",
          "description": "Trigger Rule to be used",
          "optionsArray": [
            "all_success",
            "all_failed",
            "all_done",
            "all_skipped",
            "one_failed",
            "one_success",
            "none_failed",
            "none_failed_min_one_success",
            "none_skipped",
            "always"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "5",
      "path": "/05-LegoBlock/",
      "name": "XMLParser",
      "description": "Lego Block: Execute Generic XML Parser (a wrapper around Spark XML)",
      "details": "<h2>XMLParser</h2>\n<br>\nLego Block: Execute Generic XML Parser (a wrapper around Spark XML).<br>",
      "examples": "<h2> XMLParser Examples</h2>\n<br>\n<h4> Example of Creating an XMLParser Node</h4>\n<br>\n{<br>\n\"Name\": \"MyXMLParser\",<br>\n\"StepName\": \"xml_parser_step\",<br>\n\"ClusterId\": \"\",<br>\n\"ActionOnFailure\": \"CONTINUE\",<br>\n\"deploy-mode\": \"client\",<br>\n\"jars\": \"s3://my-bucket/spark-xml_2.12-0.12.0.jar\",<br>\n\"files\": \"s3://my-bucket/log4j.properties\",<br>\n\"conf\": \"spark.executor.memory=4g,spark.executor.cores=2\",<br>\n\"class\": \"com.example.pipeline.XmlReaderPipelineMain\",<br>\n\"applicationJar\": \"s3://my-bucket/my-xml-parser-application.jar\",<br>\n\"aws_conn_id\": \"my_aws_connection\",<br>\n\"parameters\": {<br>\n\"name\": \"Ingestion-edi270\",<br>\n\"inputBasePath\": \"hdfs:///interoperability/valid/270\",<br>\n\"sourceBasePath\": \"s3://my-bucket/input/\",<br>\n\"inputPathOrder\": \"version,year,month,day,hour\",<br>\n\"outputBasePath\": \"s3://my-bucket/output/\",<br>\n\"validateXML\": \"true\",<br>\n\"processPartialInput\": \"true\",<br>\n\"RootTag\": \"X12\",<br>\n\"RowTag\": \"TS_270\",<br>\n\"version\": \"1-2\",<br>\n\"year\": \"2022\",<br>\n\"month\": \"03\",<br>\n\"day\": \"30\",<br>\n\"hour\": \"04\"<br>\n}<br>\n}<br>\n<br>\n<h4> Explanation</h4>\n<ul>\n<li> This example demonstrates how to create an XMLParser node with required configurations for Spark and EMR, including the Spark configuration properties and parameters needed for XML parsing.</li>\n</ul>\n<h4> Usage</h4>\n<ul>\n<li> Task ID: \"my_xml_parser_task\"</li>\n</ul>",
      "type": "legoblock",
      "nodeClass": "fire.pipelineNodes.XMLParser",
      "x": "585.798px",
      "y": "252.845px",
      "fields": [
        {
          "name": "Name",
          "value": "XMLParser1",
          "widget": "textfield",
          "title": "Task Name",
          "description": "Name of the task in airflow dag and it should be unique in the dag.",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "StepName",
          "value": "EMR-1905-HDC-Daily-{{execution_date.in_timezone('America/Chicago').strftime('%Y%m%d')}}",
          "widget": "textfield",
          "title": "Step Name",
          "description": "Name of emr step",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ClusterId",
          "value": "",
          "widget": "textfield",
          "title": "Cluster Id",
          "description": "If Cluster Id is empty, step try to pick the cluster id from previous create emr node(task).",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "ActionOnFailure",
          "value": "CONTINUE",
          "widget": "array",
          "title": "Action On Failure",
          "description": "Action On Failure",
          "optionsArray": [
            "CANCEL_AND_WAIT",
            "CONTINUE",
            "TERMINATE_JOB_FLOW",
            "TERMINATE_CLUSTER"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "deploy-mode",
          "value": "client",
          "widget": "array",
          "title": "Deploy Mode",
          "description": "Whether to deploy your driver on the worker nodes (cluster) or locally as an external client (client)",
          "optionsArray": [
            "client",
            "cluster"
          ],
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "jars",
          "value": "s3://fire-sample-data/change-health/jar/spark-xml_2.12-0.12.0.jar",
          "widget": "textfield",
          "title": "Jars",
          "description": "Comma separted jars path location",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "files",
          "value": "s3://fire-sample-data/change-health/log4j/log4j.properties",
          "widget": "textfield",
          "title": "Files",
          "description": "Comma-separated list of files to be placed in the working directory of each executor.",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "conf",
          "value": "spark.dynamicAllocation.enabled=true",
          "widget": "textfield",
          "title": "Configuration",
          "description": "Arbitrary Spark configuration property in key=value format. Multiple configurations should be passed with comma separation. (e.g. <key>=<value>,<key2>=<value2>)",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "class",
          "value": "com.changehealthcare.ingestion.interop.pipeline.XmlReaderPipelineMain",
          "widget": "textfield",
          "title": "Class",
          "description": "The entry point for your application (e.g. org.apache.spark.examples.SparkPi)",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "applicationJar",
          "value": "s3://fire-sample-data/change-health/jar/generic-xmlparser_2.12-EMR-6.2_3.0.0-SNAPSHOT-assembly.jar",
          "widget": "textfield",
          "title": "Application Jar",
          "description": "Path to a bundled jar including your application and all dependencies.",
          "required": true,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "aws_conn_id",
          "value": "",
          "widget": "textfield",
          "title": "AWS Connection ID",
          "description": "AWS Connection ID",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "parameters",
          "value": "",
          "widget": "tab",
          "title": "Parameters",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "name",
          "value": "Ingestion-edi270",
          "widget": "textfield",
          "title": "Name",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "inputBasePath",
          "value": "hdfs:///interoperability/valid/270",
          "widget": "textfield",
          "title": "Input Base Path",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "sourceBasePath",
          "value": "s3://fire-sample-data/change-health/input ",
          "widget": "textfield",
          "title": "Source Base Path",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "inputPathOrder",
          "value": "version,year,month,day,hour",
          "widget": "textfield",
          "title": "Input Path Order",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "outputBasePath",
          "value": "s3://fire-sample-data/change-health/outputIngestion",
          "widget": "textfield",
          "title": "Output Base Path",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "validateXML",
          "value": "true",
          "widget": "textfield",
          "title": "Validate XML",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "processPartialInput",
          "value": "true",
          "widget": "textfield",
          "title": "Process Partial Input",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "RootTag",
          "value": "X12",
          "widget": "textfield",
          "title": "Root Tag",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "RowTag",
          "value": "{{task_instance.xcom_pull(key='correlation_id')}}",
          "widget": "textfield",
          "title": "Row Tag",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "version",
          "value": "1-2",
          "widget": "textfield",
          "title": "Version",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "year",
          "value": "2022",
          "widget": "textfield",
          "title": "Year",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "month",
          "value": "03",
          "widget": "textfield",
          "title": "Month",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "day",
          "value": "30",
          "widget": "textfield",
          "title": "Day",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "hour",
          "value": "04",
          "widget": "textfield",
          "title": "Hour",
          "description": "",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "6",
      "path": "/09-Documentation/",
      "name": "Sticky Note",
      "description": "Allows capturing Notes",
      "details": "<h2>Sticky Note</h2>\n<br>\nAllows capturing Notes.<br>",
      "examples": "",
      "type": "sticky",
      "nodeClass": "fire.pipelineNodes.doc.NodeStickyNote",
      "x": "296.524px",
      "y": "108.524px",
      "fields": [
        {
          "name": "bgColor",
          "value": "gray",
          "widget": "textfield",
          "title": "Bg Color",
          "description": "Background of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "width",
          "value": "194px",
          "widget": "textfield",
          "title": "Width",
          "description": "Width of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "height",
          "value": "136px",
          "widget": "textfield",
          "title": "Height",
          "description": "Height of the note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "comment",
          "value": "<p>Create EMR Cluster using instance_count as a Variable Parameter defined in Group level.</p>",
          "widget": "textarea_rich",
          "title": "Comment",
          "description": "Comments for the Pipeline",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "7",
      "path": "/09-Documentation/",
      "name": "Sticky Note",
      "description": "Allows capturing Notes",
      "details": "<h2>Sticky Note</h2>\n<br>\nAllows capturing Notes.<br>",
      "examples": "",
      "type": "sticky",
      "nodeClass": "fire.pipelineNodes.doc.NodeStickyNote",
      "x": "536.524px",
      "y": "125.524px",
      "fields": [
        {
          "name": "bgColor",
          "value": "gray",
          "widget": "textfield",
          "title": "Bg Color",
          "description": "Background of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "width",
          "value": "215.47619px",
          "widget": "textfield",
          "title": "Width",
          "description": "Width of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "height",
          "value": "117.47619px",
          "widget": "textfield",
          "title": "Height",
          "description": "Height of the note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "comment",
          "value": "<p>XML Parser adds as a step into Created EMR Cluster.</p>",
          "widget": "textarea_rich",
          "title": "Comment",
          "description": "Comments for the Pipeline",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "8",
      "path": "/09-Documentation/",
      "name": "Sticky Note",
      "description": "Allows capturing Notes",
      "details": "<h2>Sticky Note</h2>\n<br>\nAllows capturing Notes.<br>",
      "examples": "",
      "type": "sticky",
      "nodeClass": "fire.pipelineNodes.doc.NodeStickyNote",
      "x": "788.095px",
      "y": "98.7619px",
      "fields": [
        {
          "name": "bgColor",
          "value": "gray",
          "widget": "textfield",
          "title": "Bg Color",
          "description": "Background of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "width",
          "value": "227.47619px",
          "widget": "textfield",
          "title": "Width",
          "description": "Width of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "height",
          "value": "146.47619px",
          "widget": "textfield",
          "title": "Height",
          "description": "Height of the note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "comment",
          "value": "<p>Add Step EMR Job Flow node add as a step to created EMR Cluster.</p>",
          "widget": "textarea_rich",
          "title": "Comment",
          "description": "Comments for the Pipeline",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "9",
      "path": "/09-Documentation/",
      "name": "Sticky Note",
      "description": "Allows capturing Notes",
      "details": "<h2>Sticky Note</h2>\n<br>\nAllows capturing Notes.<br>",
      "examples": "",
      "type": "sticky",
      "nodeClass": "fire.pipelineNodes.doc.NodeStickyNote",
      "x": "36px",
      "y": "19px",
      "fields": [
        {
          "name": "bgColor",
          "value": "green",
          "widget": "textfield",
          "title": "Bg Color",
          "description": "Background of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "width",
          "value": "695.47619px",
          "widget": "textfield",
          "title": "Width",
          "description": "Width of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "height",
          "value": "73.47619px",
          "widget": "textfield",
          "title": "Height",
          "description": "Height of the note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "comment",
          "value": "<p><strong>PreRequisite: </strong></p><p>Goto Administration &gt;&gt; Variables &gt;&gt; Add Variable for Group &gt;&gt; (instance_count as Key , and 2 as a Value)</p>",
          "widget": "textarea_rich",
          "title": "Comment",
          "description": "Comments for the Pipeline",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    },
    {
      "id": "10",
      "path": "/09-Documentation/",
      "name": "Sticky Note",
      "description": "Allows capturing Notes",
      "details": "<h2>Sticky Note</h2>\n<br>\nAllows capturing Notes.<br>",
      "examples": "",
      "type": "sticky",
      "nodeClass": "fire.pipelineNodes.doc.NodeStickyNote",
      "x": "267px",
      "y": "366px",
      "fields": [
        {
          "name": "bgColor",
          "value": "blue",
          "widget": "textfield",
          "title": "Bg Color",
          "description": "Background of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "width",
          "value": "666.47619px",
          "widget": "textfield",
          "title": "Width",
          "description": "Width of the Note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "height",
          "value": "77.47619px",
          "widget": "textfield",
          "title": "Height",
          "description": "Height of the note",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        },
        {
          "name": "comment",
          "value": "<h3>Using Dynamic Instance Variable</h3><ul><li><strong>Purpose</strong>: Configures an EMR cluster dynamically by setting parameters such as instance types, and instance count as variables.</li></ul>",
          "widget": "textarea_rich",
          "title": "Comment",
          "description": "Comments for the Pipeline",
          "required": false,
          "display": true,
          "editable": true,
          "expandable": false,
          "disableRefresh": false,
          "keyValue": false
        }
      ]
    }
  ],
  "edges": [
    {
      "source": "2",
      "target": "1",
      "id": 1
    },
    {
      "source": "1",
      "target": "5",
      "id": 2
    },
    {
      "source": "5",
      "target": "4",
      "id": 3
    }
  ]
}