{
  "id": "11",
  "name": "Pdf Attachments from Emails",
  "iconImage": "/images/icons/node-icon/email.svg",
  "description": "This node reads emails and download Pdf Attachments from all provided email addresses",
  "type": "pyspark",
  "engine": "pyspark",
  "nodeClass": "fire.nodes.util.NodeDownloadMailAttachments",
  "fields" : [

    {"name": "subjectFilter", "display": true, "value": "", "widget": "textfield", "title": "Filter By Subject", "description": "Filter emails with attachments based on the subject.(Optional)"},
    {"name": "attachmentsDir", "value": "", "widget": "textfield", "title": "Save Attachments To Path", "description": "Directory path to save the downloaded attachments.", "required": "true"},
    {"name": "top", "value": "", "widget": "textfield", "title": "Top", "description": "Number of most recent Emails to Fetch"},
    {"name": "emailAddressList", "value": "", "widget": "textarea_small", "title": "Email Address List", "description": "List of email addresses separated by commas or semicolon. Attachments will be fetched from these emails.", "required": "true"},

    {"name": "Microsoft", "value": "", "widget": "tab", "title": "Microsoft Graph API Configuration", "description": "Configuration for Microsoft Graph API."},
    {"name": "clientId", "value": "", "widget": "textfield", "title": "Client Id", "description": "Client ID for Microsoft authentication.", "required": "true"},
    {"name": "clientSecret", "value": "", "widget": "textfield", "title": "Client Secret", "description": "Client secret for Microsoft authentication.", "required": "true"},
    {"name": "tenantId", "value": "", "widget": "textfield", "title": "Tenant Id", "description": "Tenant ID for Microsoft authentication.", "required": "true"}
  ]
}

start-details:
h2: Pdf Attachments From Email Node Details

This node reads emails from specified email addresses and downloads PDF attachments. It filters emails based on a subject filter and saves the attachments in the provided directory. The node uses Microsoft Graph API for authentication and email access.

h4: Parameters to be set:

### General:

- Subject Filter: Filter emails based on their subject. Only emails containing the specified text in the subject will be processed.

- Attachments Directory: Specify the directory path where attachments will be saved.

- Top : Specify the number of most recent emails to look for attachments.

- Email Address List: Provide a list of email addresses separated by commas. Attachments will be fetched from these email accounts.

### Microsoft App Configuration:

- Client ID: Enter the Client ID for the Microsoft application used for authentication.

- Client Secret: Provide the Client Secret for the Microsoft application.

- Tenant ID: Specify the Tenant ID associated with the Microsoft application.

end-details: