{
  "id": "6",
  "name": "Pivot By",
  "description": "Pivot Node",
  "type": "transform",
  "engine": "scala",
  "nodeClass": "fire.nodes.etl.NodePivotBy",
  "fields" : [

    {"name": "aggregate", "value":"", "widget": "tab", "title": "Aggregate"},

    {"name": "groupingCols", "value":"[]", "widget": "variables", "title": "Grouping Columns", "description": "Grouping Columns"},
    {"name": "aggregateCols", "value":"[]", "widget": "variables_list_select", "title": "Aggregate Columns", "description": "Aggregate Columns"},
    {"name": "aggregateOperations", "value":"[]", "widget": "variables_list_array",
            "optionsArray": ["sum", "avg", "min", "max", "count"], "title": "Aggregate Operation to use", "description": "Aggregate Operation"},

    {"name": "pivot", "value":"", "widget": "tab", "title": "Pivot"},
    {"name": "pivotCol", "value":"[]", "widget": "variable", "title": "Pivot Column", "description": "Pivoting Column",
      "required":"true"},
    {"name": "uniqueValues", "value":"", "widget": "textfield", "title": "UniqueValues", "description": "Comma separated unique values: Providing Unique values while performing pivot operation improves the performance of the operation since Spark does not have to first compute the list of distinct values of Pivot Column internally."},

    {"name": "schema", "value":"", "widget": "tab", "title": "InferSchema"},

    {"name":"outputColNames", "value":"[]", "widget": "schema_col_names", "title": "Column Names of the Table", "description": "Output Columns Names of the Table"},
    {"name":"outputColTypes", "value":"[]", "widget": "schema_col_types", "title": "Column Types of the Table", "description": "Output Column Types of the Table"},
    {"name":"outputColFormats", "value":"[]", "widget": "schema_col_formats", "title": "Column Formats", "description": "Output Column Formats"}

  ]
}

start-details:

This node creates a Dataframe based on the Pivot table created out of the incoming Dataframe.

Pivot table is created by Aggregation of rows by applying the Aggregate functions on the Aggregate Columns against the Grouping and Pivot Columns selected.

end-details:

start-examples:

Incoming Dataframe has following rows:

EMP_CD    |    EMP_NAME    |    LOCATION    |    DEPT         |    SALARY
-----------------------------------------------------------------------------
E01       |    DAVID       |    NEW YORK    |    HR           |    10000
E02       |    JOHN        |    NEW JERSEY  |    SALES        |    11000
E03       |    MARTIN      |    NEW YORK    |    MARKETING    |    12000
E04       |    TONY        |    NEW JERSEY  |    MARKETING    |    13000
E05       |    ROSS        |    NEW YORK    |    FRONT DESK   |    10000
E06       |    LISA        |    NEW JERSEY  |    FRONT DESK   |    11000
E07       |    PAUL        |    NEW YORK    |    MAINTENANCE  |    12000
E08       |    MARK        |    NEW JERSEY  |    MAINTENANCE  |    13000

if PivotBy node is configured as below:

GROUPING COLUMNS      :    DEPT
PIVOT COLUMNS         :    LOCATION

AGGREGATE COLUMNS    |    AGGREGATE OPERATION
-------------------------------------------------
EMP_CD               |    COUNT

then outgoing Dataframe would be created as below after performing specified aggregation
Count of Employees for each combination of [DEPT] and [LOCATION] would be listed as below:

DEPT         |    NEW JERSEY       |    NEW YORK
---------------------------------------------------
FRONT DESK   |    1                |    1
MARKETING    |    1                |    1
HR           |                     |    1
SALES        |    1                |
MAINTENANCE  |    1                |    1

end-examples:
